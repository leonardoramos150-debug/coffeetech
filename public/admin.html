<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Painel Admin - CoffeeTech</title>
  <style>
    body { 
      font-family: sans-serif; 
      max-width: 800px; 
      margin: 0 auto; 
      padding: 20px; 
      background: #f4f4f9; 
    }

    .card { 
      background: white; 
      padding: 20px; 
      margin-bottom: 20px; 
      border-radius: 8px; 
      box-shadow: 0 2px 5px rgba(0,0,0,0.1); 
    }

    input { 
      padding: 10px; 
      width: 40%; 
      margin-right: 10px; 
      border: 1px solid #ddd; 
      border-radius: 4px; 
    }

    button { 
      padding: 10px 20px; 
      background: #6f4e37; 
      color: white; 
      border: none; 
      border-radius: 4px; 
      cursor: pointer; 
    }

    button:hover { 
      background: #5a3e2b; 
    }

    button.delete { 
      background: #ff4444; 
      padding: 5px 10px; 
      margin-left: 10px; 
    }

    li { 
      padding: 10px; 
      border-bottom: 1px solid #eee; 
      display: flex; 
      justify-content: space-between; 
      align-items: center; 
    }
  </style>
</head>
<body>

  <h1>â˜• Painel Administrativo CoffeeTech</h1>

  <div class="card">
    <h3>Novo Cliente</h3>
    <input type="text" id="nome" placeholder="Nome Completo">
    <input type="email" id="email" placeholder="E-mail">
    <button id="btnSalvar" onclick="salvarUsuario()">Cadastrar</button>
  </div>

  <div class="card">
    <h3>Lista de Interessados</h3>
    <ul id="lista">Carregando...</ul>
  </div>

  <script>
    const API_URL = 'http://localhost:3000/usuarios';
    let editandoId = null;

    async function carregarLista() {
      const resposta = await fetch(API_URL);
      const usuarios = await resposta.json();

      const lista = document.getElementById('lista');
      lista.innerHTML = '';

      usuarios.forEach(user => {
        const li = document.createElement('li');
        li.innerHTML = `
          <span>
            <strong>${user.nome}</strong> (${user.email})
          </span>
          <div>
            <button onclick="editarUsuario(${user.id}, '${user.nome}', '${user.email}')">Editar</button>
            <button class="delete" onclick="deletarUsuario(${user.id})">Remover</button>
          </div>
        `;
        lista.appendChild(li);
      });
    }

    async function salvarUsuario() {
      const nome = document.getElementById('nome').value;
      const email = document.getElementById('email').value;

      if (!nome || !email) {
        alert('Preencha tudo!');
        return;
      }

      await fetch(API_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ nome, email })
      });

      document.getElementById('nome').value = '';
      document.getElementById('email').value = '';

      carregarLista();
    }

    function editarUsuario(id, nome, email) {
      document.getElementById('nome').value = nome;
      document.getElementById('email').value = email;

      editandoId = id;

      const btn = document.getElementById('btnSalvar');
      btn.innerText = 'Atualizar';
      btn.onclick = () => atualizarUsuario();
    }

    async function atualizarUsuario() {
      const nome = document.getElementById('nome').value;
      const email = document.getElementById('email').value;

      if (!nome || !email) {
        alert('Preencha tudo!');
        return;
      }

      await fetch(`${API_URL}/${editandoId}`, {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ nome, email })
      });

      document.getElementById('nome').value = '';
      document.getElementById('email').value = '';

      editandoId = null;

      const btn = document.getElementById('btnSalvar');
      btn.innerText = 'Cadastrar';
      btn.onclick = salvarUsuario;

      carregarLista();
    }

    async function deletarUsuario(id) {
      if (confirm('Tem certeza que deseja remover este cliente?')) {
        await fetch(`${API_URL}/${id}`, { method: 'DELETE' });
        carregarLista();
      }
    }

    carregarLista();
  </script>

</body>
</html>
